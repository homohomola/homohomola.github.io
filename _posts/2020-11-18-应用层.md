---
layout:     post
title:      应用层
subtitle:   TCP/IP第5层
date:       2020-11-18
author:     sakura
header-img: img/the-first.png
catalog: true
tags:
    - 计算机网络
---

# 6 应用层

解决通过应用进程的交互来实现特定网络应用的问题



## 6.1 网络应用模型

### 6.1.1 客户/服务器方式 C/S方式

客户和服务器是指通信所涉及到的两个**进程**

服务器总是处于运行状态，并等待客户的服务请求

在C/S应用中，常用计算机群集(服务器场)构建一个强大的虚拟服务器

**特点**

- 网络中计算机地位不平等
- 网络的管理工作由少数服务器承担，管理集中方便
- 可拓展性不佳，受限于服务器硬件和网络带宽，支持客户数有限

### 6.1.2 对等方式 P2P方式

不区分服务请求/提供方，只要两主机都运行P2P软件，就能进行对等连接通信。

本质上还是C/S模式，只是每个主机既是客户又是服务器、

**特点**

- 系统可扩展性好，系统每增加一个对等方，服务请求方和提供方都增加，系统性能不会因规模增大而降低
- 网络更加健壮，不存在中心结点失效问题
- 分布式计算，可以利用每个结点空闲的计算能力和存储空间



## 6.2 域名系统DNS

一个主机名可以对应IP地址，一个IP地址也可以对应多个主机名

### 6.2.1 层次域名空间

域名(Domain name),级别低的写在左边，不区分大小写

顶级域名TLD(Top Level Domain)

- 国家顶级域名nTLD
- 通用顶级域名gTLD
- 基础结构域名(反向域名.arpa)

### 6.2.2 域名服务器

DNS设计成联机分布式的数据库系统，采用C/S模式

- 根域名服务器
    - 用于管辖顶级域名，不转换域名，而是告诉本地域名服务器下一步应找哪个顶级服务器
- 顶级域名服务器
    - 负责管理在该顶级域名服务器注册的所有**二级域名**(可能是最后结果，也可能是下一域名服务器的IP地址)
- 权限域名服务器
    - 负责一个区(Zone)的域名服务器(可能是最后结果)
- 本地域名服务器
    - 默认域名服务器,主机发送DNS查询给本地域名服务器，由本地域名服务器负责查询域名的IP地址

### 6.2.3 域名解析过程

**主机向本地域名服务器采用递归查询**

- 迭代查询
    - 域名服务器告诉本地域名服务器下一个应查询的服务器地址
    - 由本地域名服务器依次查询

![image-20201017140441582](https://gitee.com/happy_every/note_pic/raw/master/image-20201017140441582.png)

- 递归查询
    - 本地域名服务器只需查询一次，后面的查询在各服务器间进行
    - 对服务器开销大，一般不常用

![image-20201017140429364](https://gitee.com/happy_every/note_pic/raw/master/image-20201017140429364.png)



## 6.3 文件传输协议FTP

Flie Transfer Protocol，端口号21/20，使用C/S模式

FTP服务器进程组成：

- 一个主进程，负责接受新的请求
- 若干个从属进程，负责处理单个请求

### 6.3.1 工作原理

- 打开端口号21，用于建立传送**控制命令**的TCP连接
- 等待客户进程发送连接请求

- 启动从属进程处理客户进程发送来的请求，在运行期间可能还根据需要创建一些子进程
- 回到等待状态，接受其他客户进程的请求



### 6.3.2 控制连接和数据连接

- 控制连接，一直打开，用于传送FTP控制命令
- 数据连接，用于文件传输，每次文件传输才建立，结束就关闭
- 默认情况下，使用端口号21进行控制连接；端口号20进行数据连接(主动模式下)
- 被动模式下数据传输端口号由服务器和客户端自行协商决定



## 6.4 电子邮件

### 6.4.1 电子邮件组成结构

主要构件

- 用户代理UA：用户与邮件系统的接口，又称电子邮件客户端，如Outlook
- 邮件服务器：发送和接受邮件
- 电子邮件使用协议：SMTP、POP

### 6.4.2 SMTP

简单邮件传送协议SMTP运行在TCP上，端口号25

只能传送ASCII码

为解决此问题，使用**通用互联网邮件扩展MIME**，将非ASCII转化为ASCII码

### 6.4.3 POP3

邮件读取协议POP3，端口号110，用户只能**下载并删除**方式从邮件服务器下载邮件

互联网邮件访问协议IMAP：用户可以在自己的计算上操控邮件服务器里的邮件，为联机协议，端口号143

### 6.4.4 基于WWW的电子邮件

通过浏览器登入邮件服务器

用户浏览器与服务器间使用HTTP协议，服务器间使用SMTP协议



## 6.5 万维网WWW

### 6.5.1 WWW组成结构

WWW使用同一资源定位符URL来标志文档

URL格式： <协议>://<主机>:<端口号>/<路径>

### 6.5.2 HTTP

HTTP两类报文

- 请求报文
- 响应报文



HTTP工作方式

- 非持久连接HTTP/1.0
    - 对于每一个网页对象(文档)都建立TCP连接，传输结束断开
- 持久连接HTTP1.1
    - 发送响应后仍保持连接
    - 非流水线
        - 客户收到前一个请求响应后才能发送新的请求
        - 每个引用一个RTT延迟
    - 流水线
        - 客户和服务器可连续发送请求和响应
        - 只有一个RTT延迟



